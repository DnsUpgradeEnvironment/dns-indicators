{%- assign indicators_plural = page.t.general.indicators | downcase -%}

{%- for goalreport in include.goals -%}
  {%- assign goal_number = goalreport.goal -%} <!--7-->
  {%- assign goal_short_key = goal_number | append: '-short' -%} <!--7-short-->
  {%- assign goal_short = page.t.global_goals[goal_short_key] -%} <!--Bezahlbare und saubere Energie-->

  {%- assign goal = goalreport.goal | strip | sdg_lookup -%}
  <div class="goal reporting-status-item">
    <div class="frame goal-tiles">
        <a href="{{ goal.url }}">
        <img src="{{ goal.icon }}" alt="{{ goal.short | escape }} - {{ page.t.general.goal }} {{ goal.number }}" width="100" height="100" class="goal-icon-{{ goal.number }} goal-icon-image goal-icon-image-{{ site.goal_image_extension }}"/>
        </a>
    </div>
    <div class="details">
      <h3 class="status-goal">
          <a href="{{ goal.url }}">{{ goal.short }}</a>
      </h3>

      {% assign goal_indicators = page.indicators | where: 'goal_number', goal.number | group_by: 'target_id' %}
      {%- for group in goal_indicators -%}
        {%- assign target_id = group.name -%}
        {% for indicator in group.items %}
          {% for single_indicator in (1..3) %}
            {% assign weather_active_key = "weather_active_" | append: single_indicator %} <!--weather_active_2-->
            {% assign single_indicator_key = "weather_indicator_" | append: single_indicator %}  <!--weather_indicator_1-->

            {% assign idc_sort_order = indicator["indicator_sort_order"] %} <!--7-1-ab-->
            {% assign letters = "i,h,g,f,e,d,c,b,a" | split: ',' %}
            {% assign additional_cells = letters.size %}
            {% if indicator[weather_active_key] == true %}
              {% assign indicator_key = idc_sort_order | append: "_" | append: single_indicator %} <!--7-1-ab_1-->
              <!--Check for multiple targets-->
              {% assign target_key = single_indicator_key | append: "_target" %}  <!--weather_indicator_2_target-->
              {% assign target_year_key = target_key | append: "_year" %} <!--weather_indicator_2_target_year-->
              {% assign test_target_key = target_key | append: "_1" %}  <!--weather_indicator_2_target_1-->

              {% if indicator[test_target_key] %}
                {% assign target_trans = 'multi_target' %}
              {% else %}
                {% assign target_trans = 'single_target' %}
              {% endif %}
              <table class="table table-hover tableresp">

                <!-- INDICATOR !!!!!!!!!!!!!!!!-->
                <tr>
                  <th width="10%"> <div class=responsiveText>{{ page.t.weather.indicator }}</div> </th>
                  <th colspan="9"> <a href=" {{ site.baseurl }}{{ baseurl_folder }}/{{ idc_sort_order }}/ "><div class=responsiveText>{{ target_trans }}{{ indicator[single_indicator_key] }}</div></a> </th>
                </tr>
                <!-- !!!!!!!!!!!!!!!!-->
                {% if target_trans == 'single_target' %}

                  <!--Check for old targets-->
                  {% assign old_target_key = target_key | append: '_old' %} <!--weather_indicator_1_target_old-->
                  {% if indicator[old_target_key] %}
                    <tr> <th> <div> Yes</div></th></tr>
                    {% assign cases = '_old,_new' | split: ',' %}
                  {% else %}
                    <tr> <th> <div> No</div></th></tr>
                    {% assign cases = '' | split: ',' %}
                  {% endif %}

                  {% for case in cases %}
                    {% assign target_trans = target_trans | append: case %} <!--single_target_old-->
                    {% assign target_key = target_key | append: case %} <!--weather_indicator_1_target_old or weather_indicator_1_target-->
                    <!-- TARGET !!!!!!!!!!!!!!!!-->
                    <tr>
                      <th> <div class=responsiveText>1{{ page.t.weather.target_trans }}</div></th>
                      <td colspan="9"> <div class=responsiveText>2{{ indicator[target_key] }}</div> </td>
                    </tr>
                    <!-- !!!!!!!!!!!!!!!!-->
                    <!-- YEAR !!!!!!!!!!!!!!!!-->
                    <tr>
                      <th> <div class=responsiveText>3{{ page.t.general.year }}</div> </th>
                      {% for letter in letters %}
                        {% assign year_key = target_key | append:'_year_' | append: letter %}
                        {% if indicator[year_key] %}
                          {% if letter == 'i' or letter == 'h' or letter == 'g' or letter == 'f' or letter == 'e' %}
                            <td width="10%" align="center" class="hidden-xs"> <p><span class="responsiveText hidden-xs">4{{ indicator[year_key] }}</span></p> </td>
                          {% else %}
                            <td width="10%" align="center"> <p><span class="responsiveText">5{{ indicator[year_key] }}</span></p> </td>
                          {% endif %}

                          {% assign additional_cells = additional_cells | minus: 1 %}
                        {% endif %}
                      {% endfor %}
                      {% if additional_cells == letters.size %}
                        {% assign add = add | minus: 1 %}
                      {% endif %}

                      <!--add empty cells-->
                      {% for empty_cell in (1..additional_cells) %}
                        {% if empty_cell > 5 %}
                          <td width="10%" align="center"> </td>
                        {% else %}
                          <td width="10%" align="center" class="hidden-xs"> </td>
                        {% endif %}
                      {% endfor %}
                    </tr>
                    <!-- !!!!!!!!!!!!!!!!-->
                    <!-- ITEM !!!!!!!!!!!!!!!!-->
                    <tr>
                      <th> <div class=responsiveText>6{{ page.t.general.status }}</div> </th>
                      {% for letter in letters %}
                        {% assign item_key = target_key | append:'_item_' | append: letter %}
                        {% if indicator[item_key] %}

                          {% if indicator[item_key] == 'Sonne' %}
                            {% assign status = page.t.weather['sonne'] %}
                          {% elsif indicator[item_key] == 'Leicht bewölkt' %}
                            {% assign status = page.t.weather['leicht bewölkt'] %}
                          {% elsif indicator[item_key] == 'Wolke' %}
                            {% assign status = page.t.weather['wolke'] %}
                          {% elsif indicator[item_key] == 'Blitz' %}
                            {% assign status = page.t.weather['blitz'] %}
                          {% endif %}

                          {% if letter == 'i' or letter == 'h' or letter == 'g' or letter == 'f' or letter == 'e' %}
                            <td width="10%" align="center" class="hidden-xs"> <a href=" {{ site.baseurl }}{{ baseurl_folder }}/status/ ">7<img src="https://g205sdgs.github.io/sdg-indicators/public/Wettersymbole/{{ current_language }}/{{ indicator[item_key] }}.png" alt="{{ status }}" class="responsiveWeather hidden-xs" title="{{ status }}"/></a> </td>
                          {% else %}
                            <td width="10%" align="center"> <a href=" {{ site.baseurl }}{{ baseurl_folder }}/status/ ">8<img src="https://g205sdgs.github.io/sdg-indicators/public/Wettersymbole/{{ current_language }}/{{ indicator[item_key] }}.png" alt="{{ indicator[item_key] }}" class="responsiveWeather" title="{{ status }}"/></a> </td>
                          {% endif %}
                        {% elsif j == 'a' %}
                            <td width="10%" align="center"><p><span class="responsiveText">9{{ page.t.weather.no_assessment }}</span></p></td>
                        {% endif %}
                      {% endfor %}

                      <!--add empty cells-->
                      {% for empty_cell in (1..additional_cells) %}
                        {% if empty_cell > 5 %}
                          <td width="10%" align="center"></td>
                        {% else %}
                          <td width="10%" align="center"class="hidden-xs"></td>
                        {% endif %}
                      {% endfor %}
                    </tr>
                    <!-- !!!!!!!!!!!!!!!!-->
                  {% endfor %} <!--for case in cases-->

                {% elsif target_trans == 'multi_target' %}
                  {% for multi_target in (1..3) %}
                    {% assign target_trans = target_trans | append: '_' | append: multi_target %} <!--multi_target_3-->
                    {% assign target_year_1_key = target_key | append: '_1_year' %} <!--weather_indicator_2_target_1_year-->
                    {% assign target_key = target_key | append: '_' | append: multi_target %}  <!--weather_indicator_2_target_3-->


                    <!--Check for old targets-->
                    {% assign old_target_key = target_key | append: '_old' %} <!--weather_indicator_2_target_3_old-->
                    {% if indicator[old_target_key] %}
                      {% assign cases = '_old,_new' | split: ',' %}
                    {% else %}
                      {% assign cases = '' | split: ',' %}
                    {% endif %}

                    {% for case in ceses %}
                      {% assign target_trans = target_trans | append: case %} <!--multi_target_3_old-->
                      {% assign target_key = target_key | append: case %} <!--indicator_1_target_old-->
                      <!-- TARGET !!!!!!!!!!!!!!!!-->
                      <tr>
                        <th> <div class=responsiveText>10{{ page.t.weather.target_trans }}</div></th>
                        <td colspan="9"> <div class=responsiveText>11{{ indicator[target_key] }}</div> </td>
                      </tr>
                      <!-- !!!!!!!!!!!!!!!!-->
                      <!-- YEAR !!!!!!!!!!!!!!!!-->
                      <tr>
                        <th> <div class=responsiveText>12{{ page.t.general.year }}</div> </th>
                        {% for letter in letters %}
                          {% assign year_key = target_key | append:'_year_' | append: letter %}
                          {% if indicator[year_key] %}
                            <!--check if year is valid or not-->
                            {% if multi_target > 1 and indicator[year_key] > indicator[target_year_1_key] %}
                              {% assign opacity = ' style="opacity: 0.2"' %}
                            {% else %}
                              {% assign opacity = '' %}
                            {% endif %}

                            {% if letter == 'i' or letter == 'h' or letter == 'g' or letter == 'f' or letter == 'e' %}
                              <td width="10%" align="center" class="hidden-xs"> <p {{ opacity }}><span class="responsiveText hidden-xs">13{{ indicator[year_key] }}</span></p> </td>
                            {% else %}
                              <td width="10%" align="center"> <p {{ opacity }}><span class="responsiveText">14{{ indicator[year_key] }}</span></p> </td>
                            {% endif %}

                            {% assign additional_cells = additional_cells | minus: 1 %}
                          {% endif %}
                        {% endfor %}
                        {% if additional_cells == letters.size %}
                          {% assign add = add | minus: 1 %}
                        {% endif %}

                        <!--add empty cells-->
                        {% for empty_cell in (1..additional_cells) %}
                          {% if empty_cell > 5 %}
                            <td width="10%" align="center"> </td>
                          {% else %}
                            <td width="10%" align="center" class="hidden-xs"> </td>
                          {% endif %}
                        {% endfor %}
                      </tr>
                      <!-- !!!!!!!!!!!!!!!!-->
                      <!-- ITEM !!!!!!!!!!!!!!!!-->
                      <tr>
                        <th> <div class=responsiveText>15{{ page.t.general.status }}</div> </th>
                        {% for letter in letters %}
                          {% assign item_key = target_key | append:'_item_' | append: letter %}
                          {% if indicator[item_key] %}

                            {% if indicator[item_key] == 'Sonne' %}
                              {% assign status = page.t.weather['sonne'] %}
                            {% elsif indicator[item_key] == 'Leicht bewölkt' %}
                              {% assign status = page.t.weather['leicht bewölkt'] %}
                            {% elsif indicator[item_key] == 'Wolke' %}
                              {% assign status = page.t.weather['wolke'] %}
                            {% elsif indicator[item_key] == 'Blitz' %}
                              {% assign status = page.t.weather['blitz'] %}
                            {% endif %}

                            {% if letter == 'i' or letter == 'h' or letter == 'g' or letter == 'f' or letter == 'e' %}
                              <td width="10%" align="center" class="hidden-xs"> <a href=" {{ site.baseurl }}{{ baseurl_folder }}/status/ ">16<img src="https://g205sdgs.github.io/sdg-indicators/public/Wettersymbole/{{ current_language }}/{{ indicator[item_key] }}.png" alt="{{ status }}" class="responsiveWeather hidden-xs" title="{{ status }}" {{ opacity }}/></a> </td>
                            {% else %}
                              <td width="10%" align="center"> <a href=" {{ site.baseurl }}{{ baseurl_folder }}/status/ ">17<img src="https://g205sdgs.github.io/sdg-indicators/public/Wettersymbole/{{ current_language }}/{{ indicator[item_key] }}.png" alt="{{ indicator[item_key] }}" class="responsiveWeather" title="{{ status }}" {{ opacity }}/></a> </td>
                            {% endif %}
                          {% elsif j == 'a' %}
                              <td width="10%" align="center"><p><span class="responsiveText">18{{ page.t.weather.no_assessment }}</span></p></td>
                          {% endif %}
                        {% endfor %}

                        <!--add empty cells-->
                        {% for empty_cell in (1..additional_cells) %}
                          {% if empty_cell > 5 %}
                            <td width="10%" align="center"></td>
                          {% else %}
                            <td width="10%" align="center"class="hidden-xs"></td>
                          {% endif %}
                        {% endfor %}
                      </tr>
                      <!-- !!!!!!!!!!!!!!!!-->
                    {% endfor %} <!--case-->
                  {% endfor %} <!--multi_target-->
                {% endif %} <!-- target_trans == 'single_target' -->




              </table>
            {% endif %}
          {% endfor %}
        {% endfor %}
      {%- endfor -%}
      <div class="divider"></div>
    </div>
    <br style="clear:both;">
  </div> <!--class="goal"-->
{%- endfor -%} <!--for goalreport in site.data.reporting.goals-->

{% include footer.html %}
