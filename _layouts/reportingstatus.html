{% include head.html %}
{% include header.html %}

{% assign reporting_data = site.data.reporting %}
{% if site.data[page.language].reporting %}
  {% assign reporting_data = site.data[page.language].reporting %}
{% endif %}

{% assign goals = reporting_data.goals %}
<script>
  console.log( {{ goals }} );
</script>

<div id="main-content" class="container reportingstatus" role="main">

  <h1>{{ page.t.summary.status_summary }}</h1>

  {%- for goalreport in goals -%}
    {%- assign goal = goalreport.goal | downcase | sdg_lookup -%}
    {%- assign goal_number = goal.number -%}
    {%- assign goal_short_key = goal_number | append: '-short' -%}
    {%- assign goal_short = page.t.global_goals[goal_short_key] -%}

    <div class="goal reporting-status-item">
      <div class="frame goal-tiles">
        <a href="{{ goal.url }}">
          <img src="{{ goal.icon }}" alt="{{ goal.short | escape }} - {{ page.t.general.goal }} {{ goal.number }}" width="100" height="100" class="goal-icon-{{ goal.number }} goal-icon-image goal-icon-image-{{ site.goal_image_extension }}"/>
        </a>
      </div>
      <div class="details">
        <h3 class="status-goal">
          <a href="{{ site.baseurl }}{{ baseurl_folder }}/{{ goal_number }}/"><span class="visible-xs">{{ page.t.general.goal }} {{ goal_number}} - <span>{{ goal_short }}</a>
        </h3>
        <!--{% assign goal_indicators = site.data.meta | where: 'sdg_goal', goal_number | group_by: 'target_id' %}-->
        {% assign goal_indicators = page.indicators | where: 'sdg_goal', goal.number | group_by: 'target_id' %}
        {% for group in goal_indicators %}
          {% for indicator in group.items %}
            {% for i in (1..3) %}
              {% assign hty_active = "history_active_" | append: i %}
              {% assign hty_indicator = "history_indicator_" | append: i %}
              {% assign hty_target = "history_target_" | append: i %}
              {% if indicator[hty_active] == true %}
                <table class="table table-hover tableresp">
                  <tr>
                    <th width="10%"> <div class=responsiveText>{{ page.t.summary.indicator }}</div> </th>
                    <td colspan="9"> <a href=" {{ site.baseurl }}{{ baseurl_folder }}/{{ indicator[permalink] }}/ "><div class=responsiveText>{{ indicator[hty_indicator] }}</div></a> </td> <!--{{ indicator[hty_indicator] }}</div></a> </th>-->
                  </tr>
                  <tr>
                    <th> <div class=responsiveText>{{ page.t.summary.target }} </div></th>
                    <td colspan="9"> <div class=responsiveText>{{ indicator[hty_target] }}</div> </td> <!--{{ t.summary[target_key] }}</div> </td>-->
                  </tr>
                  <tr>
                    <th> <div class=responsiveText>{{ page.t.summary.year }}</div> </th>
                    {% assign letters = "g,f,e,d,c,b,a" | split: ',' %}
                    {% assign add = letters.size %}
                    {% for letter in letters %}
                      {% assign year = "history_year_" | append: letter | append: "_" | append: i %}
                      {% if indicator[year] %}
                        {% if j == 'g' or j == 'f' or j == 'e' %}
                          <td width="10%" align="center" class="hidden-xs"> <p><span class="responsiveText hidden-xs">{{ indicator[year] }}</span></p> </td>
                        {% else %}
                          <td width="10%" align="center"> <p><span class="responsiveText">{{ indicator[year] }}</span></p> </td>
                        {% endif %}

                        {% assign add = add | minus: 1 %}
                      {% endif %}
                    {% endfor %}

                    {% if add == letters.size %}
                      {% assign add = add | minus: 1 %}
                    {% endif %}

                    {% for k in (1..add) %}<!--add empty cells-->
                      {% if k > 3 %}
                        <td width="10%" align="center"> </td>
                      {% else %}
                        <td width="10%" align="center" class="hidden-xs"> </td>
                      {% endif %}
                    {% endfor %}
                  </tr>
                </table>



              {% endif %}
            {% endfor %}

          {% endfor %}
        {% endfor %}

      </div>


    </div>
  {%- endfor -%}
</div>
{% include footer.html %}
